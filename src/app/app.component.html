<main class="main">
  <div fxLayout="column" class="content">
    <div
      class="top-bar-nav"
      fxLayout="row"
      fxLayoutAlign="space-between center"
    >
      <div fxLayout="column">
        <!-- Title div -->
        <div class="nav">
          <h1 class="nav-title">{{ title }}</h1>
        </div>
      </div>

      <!-- Viewing mode toggle div -->
      <div fxLayout="column" class="menu-mode">
        <!-- 
            Angular toggle here from grid to list view
          -->

        <div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="40px">
          <mat-icon class="login-icon"> person </mat-icon>
        </div>
      </div>
    </div>

    <!-- Count + Controls div -->
    <div class="count" [style.visibility]="loggedIn ? 'visible' : 'hidden'">
      <p class="count-title">
        Your collection contains {{ userCards?.length ?? 0 }} cards.
        <mat-icon class="info-icon" matTooltip="Click card for more info."
          >info</mat-icon
        >
      </p>

      <div
        class="controls"
        fxLayout="row"
        fxLayoutAlign="center center"
        fxLayoutGap="40px"
      >
        <div
          class="size-control"
          fxLayout="row"
          fxLayoutAlign="center center"
          fxLayoutGap="5px"
        >
          <mat-icon>view_comfy</mat-icon>
          <mat-slider [disabled]="isMobileLayout" min="100" max="400" step="5">
            <input matSliderThumb value="200" #cardSize />
          </mat-slider>
          <mat-icon>view_module</mat-icon>
        </div>

        <div
          class="view-toggle"
          fxLayout="row"
          fxLayoutAlign="center center"
          fxLayoutGap="30px"
        >
          <mat-slide-toggle
            #cardViewElement
            class="menu-slide"
            [checked]="cardView"
            (change)="updateView()"
          >
          </mat-slide-toggle>
        </div>
      </div>
    </div>

    <!-- Login dialog-->
    <login class="login" *ngIf="!loggedIn"></login>

    <!-- Cards -->
    <div *ngIf="cardView">
      <div class="md-padding row-wrap row-gap-center-start">
        <div
          class="card-row"
          [ngStyle]="{ 'minWidth.px': convertStringToNumber(cardSize.value) }"
          *ngFor="let card of userCards"
        >
          <card
            [width]="convertStringToNumber(cardSize.value)"
            [card]="card"
          ></card>
        </div>
      </div>
    </div>

    <!-- List View -->
    <div *ngIf="!cardView">
      <table
        [style.visibility]="loggedIn ? 'visible' : 'hidden'"
        mat-table
        [dataSource]="userCards"
        class="mat-elevation-z8 demo-table"
      >
        <!-- Delete Column -->
        <ng-container matColumnDef="demo-delete">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let element">
            <button
              class="trash-button"
              mat-mini-fab
              color="warn"
              (click)="removePlayer(element['playerName'])"
            >
              <mat-icon> delete </mat-icon>
            </button>
          </td>
        </ng-container>

        <!-- Position Column -->
        <ng-container matColumnDef="demo-position">
          <th mat-header-cell *matHeaderCellDef>No.</th>
          <td mat-cell *matCellDef="let element">
            {{ element["cardNumber"] }}
          </td>
        </ng-container>

        <!-- Name Column -->
        <ng-container matColumnDef="demo-name">
          <th mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell *matCellDef="let element">
            {{ element["playerName"] }}
          </td>
        </ng-container>

        <!-- Weight Column -->
        <ng-container matColumnDef="demo-weight">
          <th mat-header-cell *matHeaderCellDef>Company</th>
          <td mat-cell *matCellDef="let element">
            {{ element["cardCompany"] }}
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>
  </div>

  <!-- Static add button -->
  <button
    [style.visibility]="loggedIn ? 'visible' : 'hidden'"
    mat-fab
    color="black"
    (click)="onFormButtonClick()"
    class="bottom-right-button"
  >
    <b style="font-size: x-large">+</b>
  </button>

  <router-outlet />
</main>
